jQuery(function(a){function p(a){return a<10?"0"+a:a}function o(a){if(typeof a=="undefined")a=0;var b=new Date(a*1e3);var c=new Date(0);var d=a.toString().match(/\.([\d]{3})/);if(typeof d!="object"||!d||typeof d[1]=="undefined"){d="000"}else{d=d[1]}return p(b.getHours()-c.getHours())+":"+p(b.getMinutes())+":"+p(b.getSeconds())+","+d}function n(){a(".fileContainer").each(function(){var b=a("#"+a(this).attr("data-for"));a(this).width(b.outerWidth(true)).height(b.outerHeight(true)).css({left:b.position().left,top:b.position().top})})}window.srt="";var b=a("#subtitleList");var c=b.find("option");var d=a("#loadButton");var e=a("#videoContainer");var f=a("#loadSubtitlesButton");var g=a("#subtitlesContainer");var h=a("#srt");var i=a("#player");var j=a("#progressBar");var k=a("#progressComplete");var l=a("#subtitleOutput");var m=a("#subtitleFileName");i.bind("play",function(){b.focus()});n();a(window).resize(n);e.change(function(a){var b=a.currentTarget.files[0];m.val(b.fileName);var c=new FileReader(b);k.width(0);j.show();c.onprogress=function(a){var b=parseInt(a.loaded/a.total*100);k.text(b);k.css({width:b+"%"})};c.onloadend=function(a){if(i[0].canPlayType(b.type)!=""){i[0].src=a.currentTarget.result;i[0].play();j.hide()}else{alert("The current video format is not supported")}};c.readAsDataURL(b)});g.change(function(a){var d=a.currentTarget.files[0];var e="";var f=new FileReader(d);f.onloadend=function(a){e=a.currentTarget.result;var d=e.match(/^[^\n]+/mg);for(var f in d){if(d[f]!="")b.append("<option>"+d[f]+"</option>")}b.focus();c=b.find("option");c.removeAttr("selected").first().attr("selected","selected")};f.readAsText(d)});b.keydown(function(a){if(a.which==90){c.filter("[selected]").data("startTime",i[0].currentTime)}else if(a.which==88){var d=c.filter("[selected]").data("endTime",i[0].currentTime).removeAttr("selected").next("option").attr("selected","selected");try{b[0].scrollTop=d.index()*17}catch(e){}}else if(a.which==67){var d=c.filter("[selected]").data("endTime",i[0].currentTime).removeAttr("selected").next("option").attr("selected","selected").data("startTime",i[0].currentTime+.01);try{b[0].scrollTop=d.index()*17}catch(e){}}a.preventDefault()});h.click(function(){window.srt="";var b=0;c.each(function(){window.srt+=++b+"\n"+o(a(this).data("startTime"))+" --> "+o(a(this).data("endTime"))+"\n"+a(this).text()+"\n"});l.val(window.srt).parent().submit()})})